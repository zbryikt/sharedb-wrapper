require=function(e){function n(e){e.t="text0";var n={p:e.p.pop()};null!=e.si&&(n.i=e.si),null!=e.sd&&(n.d=e.sd),e.o=[n]}function i(e){e.p.push(e.o[0].p),null!=e.o[0].i&&(e.si=e.o[0].i),null!=e.o[0].d&&(e.sd=e.o[0].d),delete e.t,delete e.o}var t=function n(i,t){return n.m.hasOwnProperty(i)?n.m[i]:"function"!=typeof e||t?"function"==typeof n.r?n.r(i,1):void 0:e(i,1)};t.m={},t.r=e;var l=function(e,n,i,t){var l=e.transformX=function(e,r){i(e),i(r);for(var o,p,d,f=[],u=0;u<r.length;u++){for(var s=r[u],a=[],v=0;v<e.length;){var c=[];if(o=e[v],d=c,n(a,o,p=s,"left"),n(d,p,o,"right"),v++,1!==c.length){if(0===c.length){for(var h=v;h<e.length;h++)t(a,e[h]);s=null;break}for(var g=l(e.slice(v),c),m=0;m<g[0].length;m++)t(a,g[0][m]);for(var w=0;w<g[1].length;w++)t(f,g[1][w]);s=null;break}s=c[0]}null!=s&&t(f,s),e=a}return[e,f]};e.transform=function(e,i,t){if("left"!==t&&"right"!==t)throw new Error("type must be 'left' or 'right'");return 0===i.length?e:1===e.length&&1===i.length?n([],e[0],i[0],t):"left"===t?l(e,i)[0]:l(i,e)[1]}},r={},o=r={name:"text0",uri:"http://sharejs.org/types/textv0",create:function(e){if(null!=e&&"string"!=typeof e)throw new Error("Initial data must be a string");return e||""}},p=function(e,n,i){return e.slice(0,n)+i+e.slice(n)},d=function(e){if("number"!=typeof e.p)throw new Error("component missing position field");if("string"==typeof e.i==("string"==typeof e.d))throw new Error("component needs an i or d field");if(e.p<0)throw new Error("position cannot be negative")},f=function(e){for(var n=0;n<e.length;n++)d(e[n])};o.apply=function(e,n){var i;f(n);for(var t=0;t<n.length;t++){var l=n[t];if(null!=l.i)e=p(e,l.p,l.i);else{if(i=e.slice(l.p,l.p+l.d.length),l.d!==i)throw new Error("Delete component '"+l.d+"' does not match deleted text '"+i+"'");e=e.slice(0,l.p)+e.slice(l.p+l.d.length)}}return e};var u=o._append=function(e,n){if(""!==n.i&&""!==n.d)if(0===e.length)e.push(n);else{var i=e[e.length-1];null!=i.i&&null!=n.i&&i.p<=n.p&&n.p<=i.p+i.i.length?e[e.length-1]={i:p(i.i,n.p-i.p,n.i),p:i.p}:null!=i.d&&null!=n.d&&n.p<=i.p&&i.p<=n.p+n.d.length?e[e.length-1]={d:p(n.d,i.p-n.p,i.d),p:n.p}:e.push(n)}};o.compose=function(e,n){f(e),f(n);for(var i=e.slice(),t=0;t<n.length;t++)u(i,n[t]);return i},o.normalize=function(e){var n=[];null==e.i&&null==e.p||(e=[e]);for(var i=0;i<e.length;i++){var t=e[i];null==t.p&&(t.p=0),u(n,t)}return n};var s=function(e,n,i){return null!=n.i?n.p<e||n.p===e&&i?e+n.i.length:e:e<=n.p?e:e<=n.p+n.d.length?n.p:e-n.d.length};o.transformCursor=function(e,n,i){for(var t="right"===i,l=0;l<n.length;l++)e=s(e,n[l],t);return e};var a=o._tc=function(e,n,i,t){if(d(n),d(i),null!=n.i)u(e,{i:n.i,p:s(n.p,i,"right"===t)});else if(null!=i.i){var l=n.d;n.p<i.p&&(u(e,{d:l.slice(0,i.p-n.p),p:n.p}),l=l.slice(i.p-n.p)),""!==l&&u(e,{d:l,p:n.p+i.i.length})}else if(n.p>=i.p+i.d.length)u(e,{d:n.d,p:n.p-i.d.length});else if(n.p+n.d.length<=i.p)u(e,n);else{var r={d:"",p:n.p};n.p<i.p&&(r.d=n.d.slice(0,i.p-n.p)),n.p+n.d.length>i.p+i.d.length&&(r.d+=n.d.slice(i.p+i.d.length-n.p));var o=Math.max(n.p,i.p),p=Math.min(n.p+n.d.length,i.p+i.d.length);if(n.d.slice(o-n.p,p-n.p)!==i.d.slice(o-i.p,p-i.p))throw new Error("Delete ops delete different text in the same region of the document");""!==r.d&&(r.p=s(r.p,i),u(e,r))}return e},v=function(e){return null!=e.i?{d:e.i,p:e.p}:{i:e.d,p:e.p}};o.invert=function(e){e=e.slice().reverse();for(var n=0;n<e.length;n++)e[n]=v(e[n]);return e},l(o,a,f,u);var c={},h=function(e){return"[object Array]"==Object.prototype.toString.call(e)},g=function(e){return JSON.parse(JSON.stringify(e))},m={name:"json0",uri:"http://sharejs.org/types/JSONv0"},w={};m.registerSubtype=function(e){w[e.name]=e},m.create=function(e){return void 0===e?null:g(e)},m.invertComponent=function(e){var n={p:e.p};return e.t&&w[e.t]&&(n.t=e.t,n.o=w[e.t].invert(e.o)),void 0!==e.si&&(n.sd=e.si),void 0!==e.sd&&(n.si=e.sd),void 0!==e.oi&&(n.od=e.oi),void 0!==e.od&&(n.oi=e.od),void 0!==e.li&&(n.ld=e.li),void 0!==e.ld&&(n.li=e.ld),void 0!==e.na&&(n.na=-e.na),void 0!==e.lm&&(n.lm=e.p[e.p.length-1],n.p=e.p.slice(0,e.p.length-1).concat([e.lm])),n},m.invert=function(e){for(var n=e.slice().reverse(),i=[],t=0;t<n.length;t++)i.push(m.invertComponent(n[t]));return i},m.checkValidOp=function(e){for(var n=0;n<e.length;n++)if(!h(e[n].p))throw new Error("Missing path")},m.checkList=function(e){if(!h(e))throw new Error("Referenced element not a list")},m.checkObj=function(e){if(!function(e){return!!e&&e.constructor===Object}(e))throw new Error("Referenced element not an object (it was "+JSON.stringify(e)+")")},m.apply=function(e,i){m.checkValidOp(i),i=g(i);for(var t={data:e},l=0;l<i.length;l++){var r=i[l];null==r.si&&null==r.sd||n(r);for(var o=null,p=t,d="data",f=0;f<r.p.length;f++){var u=r.p[f];if(o=p,p=p[d],d=u,null==o)throw new Error("Path invalid")}if(r.t&&void 0!==r.o&&w[r.t])p[d]=w[r.t].apply(p[d],r.o);else if(void 0!==r.na){if("number"!=typeof p[d])throw new Error("Referenced element not a number");p[d]+=r.na}else if(void 0!==r.li&&void 0!==r.ld)m.checkList(p),p[d]=r.li;else if(void 0!==r.li)m.checkList(p),p.splice(d,0,r.li);else if(void 0!==r.ld)m.checkList(p),p.splice(d,1);else if(void 0!==r.lm){if(m.checkList(p),r.lm!=d){var s=p[d];p.splice(d,1),p.splice(r.lm,0,s)}}else if(void 0!==r.oi)m.checkObj(p),p[d]=r.oi;else{if(void 0===r.od)throw new Error("invalid / missing instruction in op");m.checkObj(p),delete p[d]}}return t.data},m.shatter=function(e){for(var n=[],i=0;i<e.length;i++)n.push([e[i]]);return n},m.incrementalApply=function(e,n,i){for(var t=0;t<n.length;t++){var l=[n[t]];i(l,e=m.apply(e,l))}return e};var y=m.pathMatches=function(e,n,i){if(e.length!=n.length)return!1;for(var t=0;t<e.length;t++)if(e[t]!==n[t]&&(!i||t!==e.length-1))return!1;return!0};m.append=function(e,t){if(t=g(t),0!==e.length){var l=e[e.length-1];if(null==t.si&&null==t.sd||null==l.si&&null==l.sd||(n(t),n(l)),y(t.p,l.p))if(t.t&&l.t&&t.t===l.t&&w[t.t]){if(l.o=w[t.t].compose(l.o,t.o),null!=t.si||null!=t.sd){for(var r=t.p,o=0;o<l.o.length-1;o++)t.o=[l.o.pop()],t.p=r.slice(),i(t),e.push(t);i(l)}}else null!=l.na&&null!=t.na?e[e.length-1]={p:l.p,na:l.na+t.na}:void 0!==l.li&&void 0===t.li&&t.ld===l.li?void 0!==l.ld?delete l.li:e.pop():void 0!==l.od&&void 0===l.oi&&void 0!==t.oi&&void 0===t.od?l.oi=t.oi:void 0!==l.oi&&void 0!==t.od?void 0!==t.oi?l.oi=t.oi:void 0!==l.od?delete l.oi:e.pop():void 0!==t.lm&&t.p[t.p.length-1]===t.lm||e.push(t);else null==t.si&&null==t.sd||null==l.si&&null==l.sd||(i(t),i(l)),e.push(t)}else e.push(t)},m.compose=function(e,n){m.checkValidOp(e),m.checkValidOp(n);for(var i=g(e),t=0;t<n.length;t++)m.append(i,n[t]);return i},m.normalize=function(e){var n=[];e=h(e)?e:[e];for(var i=0;i<e.length;i++){var t=e[i];null==t.p&&(t.p=[]),m.append(n,t)}return n},m.commonLengthForOps=function(e,n){var i=e.p.length,t=n.p.length;if((null!=e.na||e.t)&&i++,(null!=n.na||n.t)&&t++,0===i)return-1;if(0===t)return null;i--,t--;for(var l=0;l<i;l++){var r=e.p[l];if(l>=t||r!==n.p[l])return null}return i},m.canOpAffectPath=function(e,n){return null!=m.commonLengthForOps({p:n},e)},m.transformComponent=function(e,t,l,r){t=g(t);var o=m.commonLengthForOps(l,t),p=m.commonLengthForOps(t,l),d=t.p.length,f=l.p.length;if((null!=t.na||t.t)&&d++,(null!=l.na||l.t)&&f++,null!=p&&f>d&&t.p[p]==l.p[p]&&(void 0!==t.ld?((s=g(l)).p=s.p.slice(d),t.ld=m.apply(g(t.ld),[s])):void 0!==t.od&&((s=g(l)).p=s.p.slice(d),t.od=m.apply(g(t.od),[s]))),null!=o){var u=d==f,s=l;if(null==t.si&&null==t.sd||null==l.si&&null==l.sd||(n(t),n(s=g(l))),s.t&&w[s.t]){if(t.t&&t.t===s.t){var a=w[t.t].transform(t.o,s.o,r);if(null!=t.si||null!=t.sd)for(var v=t.p,c=0;c<a.length;c++)t.o=[a[c]],t.p=v.slice(),i(t),m.append(e,t);else(!h(a)||a.length>0)&&(t.o=a,m.append(e,t));return e}}else if(void 0!==l.na);else if(void 0!==l.li&&void 0!==l.ld){if(l.p[o]===t.p[o]){if(!u)return e;if(void 0!==t.ld){if(void 0===t.li||"left"!==r)return e;t.ld=g(l.li)}}}else if(void 0!==l.li)void 0!==t.li&&void 0===t.ld&&u&&t.p[o]===l.p[o]?"right"===r&&t.p[o]++:l.p[o]<=t.p[o]&&t.p[o]++,void 0!==t.lm&&u&&l.p[o]<=t.lm&&t.lm++;else if(void 0!==l.ld){if(void 0!==t.lm&&u){if(l.p[o]===t.p[o])return e;v=l.p[o];var y=t.p[o];(v<(O=t.lm)||v===O&&y<O)&&t.lm--}if(l.p[o]<t.p[o])t.p[o]--;else if(l.p[o]===t.p[o]){if(f<d)return e;if(void 0!==t.ld){if(void 0===t.li)return e;delete t.ld}}}else if(void 0!==l.lm)if(void 0!==t.lm&&d===f){y=t.p[o];var O=t.lm,b=l.p[o],k=l.lm;if(b!==k)if(y===b){if("left"!==r)return e;t.p[o]=k,y===O&&(t.lm=k)}else y>b&&t.p[o]--,y>k?t.p[o]++:y===k&&b>k&&(t.p[o]++,y===O&&t.lm++),O>b?t.lm--:O===b&&O>y&&t.lm--,O>k?t.lm++:O===k&&(k>b&&O>y||k<b&&O<y?"right"===r&&t.lm++:O>y?t.lm++:O===b&&t.lm--)}else void 0!==t.li&&void 0===t.ld&&u?(y=l.p[o],O=l.lm,(v=t.p[o])>y&&t.p[o]--,v>O&&t.p[o]++):(y=l.p[o],O=l.lm,(v=t.p[o])===y?t.p[o]=O:(v>y&&t.p[o]--,v>O?t.p[o]++:v===O&&y>O&&t.p[o]++));else if(void 0!==l.oi&&void 0!==l.od){if(t.p[o]===l.p[o]){if(void 0===t.oi||!u)return e;if("right"===r)return e;t.od=l.oi}}else if(void 0!==l.oi){if(void 0!==t.oi&&t.p[o]===l.p[o]){if("left"!==r)return e;m.append(e,{p:t.p,od:l.oi})}}else if(void 0!==l.od&&t.p[o]==l.p[o]){if(!u)return e;if(void 0===t.oi)return e;delete t.od}}return m.append(e,t),e},l(m,m.transformComponent,m.checkValidOp,m.append),m.registerSubtype(r);var O={type:c=m};return t.m["ot-json0"]=O,t}("function"==typeof require?require:void 0);

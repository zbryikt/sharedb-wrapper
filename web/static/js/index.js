// Generated by LiveScript 1.3.1
(function(){
  var local, click, textarea, btn1, btn2, sdb, watch, init, ldld;
  local = {};
  click = function(){
    var data, old, ops;
    data = local.doc.data;
    old = JSON.parse(JSON.stringify(data));
    (data.x || (data.x = {})).a = (+(((data.x || (data.x = {})).a || 0) + "")) + 1;
    ops = sdb.json.diff(old, data);
    return local.doc.submitOp(ops);
  };
  textarea = ld$.find(document, 'textarea', 0);
  btn1 = ld$.find(document, '.btn')[0];
  btn1.addEventListener('click', click);
  btn2 = ld$.find(document, '.btn')[1];
  btn2.addEventListener('click', function(){
    if (sdb.connected) {
      btn2.innerText = "Reconnect";
      return sdb.disconnect();
    } else {
      btn2.innerText = "Disconnect";
      sdb.reconnect();
      return init();
    }
  });
  sdb = new sharedbWrapper({
    url: {
      scheme: 'http',
      domain: 'localhost:3005'
    }
  });
  watch = function(){
    return textarea.value = JSON.stringify(local.doc.data);
  };
  init = function(){
    return sdb.get({
      id: 'sample',
      watch: watch
    }).then(function(doc){
      local.doc = doc;
      return watch();
    });
  };
  textarea.onchange = function(){
    return console.log(textarea.value);
  };
  ldld = new ldLoader({
    className: "ldld full"
  });
  return init();
})();